<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabaseUrl = 'https://your-project.supabase.co'
  const supabaseKey = 'your-anon-key-here'
  const supabase = Supabase.createClient(supabaseUrl, supabaseKey)
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Details - NEI Job Portal</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/responsive.css">
    <style>
        .job-page { padding: 3rem 0; }
        .job-card { background: white; border-radius: 15px; box-shadow: var(--box-shadow); max-width: 900px; margin: 0 auto; overflow: hidden; }
        .job-header { background: linear-gradient(135deg, #11998e, #38ef7d); padding: 2.5rem; text-align: center; color: white; }
        .job-header h1 { font-size: 2rem; margin: 0; }
        .job-body { padding: 2rem; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 1.5rem 0; }
        .info-item { background: #f8f9fa; padding: 1rem; border-radius: 10px; }
        .info-label { font-weight: 600; color: var(--text-dark); display: block; margin-bottom: 0.5rem; }
        .info-value { color: var(--primary-color); font-weight: 500; }
        .btn { background: #11998e; color: white; padding: 0.8rem 2rem; border-radius: 50px; text-decoration: none; font-weight: bold; display: inline-block; margin: 0.5rem; }
        .btn:hover { background: #0e7a6b; }
        .btn-apply { background: #e67e22; }
        .btn-apply:hover { background: #d35400; }
        .back-btn { color: var(--text-light); margin: 1.5rem 2rem; display: inline-block; }
        .section-title { font-size: 1.4rem; margin: 1.5rem 0 1rem; color: var(--text-dark); border-bottom: 2px solid var(--primary-color); padding-bottom: 0.5rem; }
        .dates-list { list-style: none; padding: 0; }
        .dates-list li { padding: 0.5rem 0; border-bottom: 1px dashed #ddd; }
        .dates-list li:last-child { border-bottom: none; }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo"><h1>NEI Job Portal</h1></div>
            <a href="../index.html" class="back-btn">← Back to Home</a>
        </div>
    </header>

    <main class="job-page">
        <div class="container">
            <div class="job-card">
                <div class="job-header">
                    <h1 id="job-title">Loading Job Details...</h1>
                    <p id="status-badge" class="job-status status-start">Apply Now</p>
                </div>
                <div class="job-body">

                    <!-- Key Info Grid -->
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Post Name</span>
                            <div class="info-value" id="post-name">Various Posts</div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Total Vacancy</span>
                            <div class="info-value" id="vacancy">Multiple</div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Last Date</span>
                            <div class="info-value" id="last-date">Coming Soon</div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Application Fee</span>
                            <div class="info-value" id="fee">Check Notification</div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Age Limit</span>
                            <div class="info-value" id="age">18-35 Years</div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Salary</span>
                            <div class="info-value" id="salary">As per rules</div>
                        </div>
                    </div>

                    <hr style="margin: 2rem 0;">

                    <!-- Eligibility -->
                    <h3 class="section-title">Eligibility</h3>
                    <p id="eligibility">Check official notification for detailed eligibility criteria.</p>

                    <!-- Important Dates -->
                    <h3 class="section-title">Important Dates</h3>
                    <ul class="dates-list" id="dates-list">
                        <li>No dates available.</li>
                    </ul>

                    <!-- Important Links -->
                    <h3 class="section-title">Important Links</h3>
                    <div style="text-align: center; margin: 1.5rem 0;">
                        <a href="#" id="official-link" class="btn" target="_blank">Official Website</a>
                        <a href="#" id="apply-link" class="btn btn-apply" target="_blank">Apply Online</a>
                        <a href="#" id="notification-link" class="btn" target="_blank">Download Notification</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>© 2025 NEI Job Portal</p>
        </div>
    </footer>

    <script>
        // Get URL params
        const urlParams = new URLSearchParams(window.location.search);
        const state = urlParams.get('state') || 'assam';
        const id = parseInt(urlParams.get('id')) || 1;

        // Fetch full job data from JSON
        fetch('../data/jobs.json')
            .then(response => {
                if (!response.ok) throw new Error('Job data not found');
                return response.json();
            })
            .then(data => {
                // Search in all categories
                let job = null;
                const categories = ['latestJobs', 'results', 'admitCards', 'answerKeys', 'centralGovtJobs', 'privateJobs'];
                for (const cat of categories) {
                    const found = (data[state]?.[cat] || []).find(j => j.id === id);
                    if (found) {
                        job = found;
                        break;
                    }
                }

                // Fallback if not found
                if (!job) {
                    job = {
                        title: "Job Not Found",
                        postName: "N/A",
                        vacancy: "N/A",
                        lastDate: "N/A",
                        fee: "N/A",
                        age: "N/A",
                        salary: "N/A",
                        eligibility: "No details available.",
                        dates: [],
                        official: "#",
                        apply: "#",
                        notification: "#",
                        status: "soon",
                        statusText: "Soon"
                    };
                }

                // Populate page
                document.getElementById('job-title').textContent = job.title;
                document.getElementById('post-name').textContent = job.postName;
                document.getElementById('vacancy').textContent = job.vacancy;
                document.getElementById('last-date').textContent = job.lastDate;
                document.getElementById('fee').textContent = job.fee;
                document.getElementById('age').textContent = job.age;
                document.getElementById('salary').textContent = job.salary;
                document.getElementById('eligibility').textContent = job.eligibility;

                // Status badge
                const badge = document.getElementById('status-badge');
                badge.textContent = job.statusText;
                badge.className = `job-status status-${job.status}`;

                // Important Dates
                const datesList = document.getElementById('dates-list');
                if (job.dates && job.dates.length > 0) {
                    datesList.innerHTML = job.dates.map(d => `<li>${d}</li>`).join('');
                } else {
                    datesList.innerHTML = '<li>No important dates available.</li>';
                }

                // Links
                document.getElementById('official-link').href = job.official;
                document.getElementById('apply-link').href = job.apply;
                document.getElementById('notification-link').href = job.notification;

                // Hide "Apply Online" if no link
                if (job.apply === "#" || !job.apply) {
                    document.getElementById('apply-link').style.display = 'none';
                }
            })
            .catch(err => {
                console.error(err);
                document.querySelector('.job-body').innerHTML = `
                    <p style="text-align:center; color:#e74c3c; font-weight:bold;">
                        Failed to load job details. Please try again later.
                    </p>
                `;
            });
    </script>
</body>
</html>
